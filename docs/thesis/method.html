<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.3 Method | PhD Thesis</title>
  <meta name="description" content="my thesis" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="3.3 Method | PhD Thesis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="my thesis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.3 Method | PhD Thesis" />
  
  <meta name="twitter:description" content="my thesis" />
  

<meta name="author" content="Irene Crisologo" />


<meta name="date" content="2020-06-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data.html"/>
<link rel="next" href="sec-resultsanddiscussion.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Using spaceborne radar platforms to enhance the homogeneity of weather radar calibration</a></li>
<li class="chapter" data-level="" data-path="abstract.html"><a href="abstract.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="" data-path="zusammenfassung.html"><a href="zusammenfassung.html"><i class="fa fa-check"></i>Zusammenfassung</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="how-weather-radars-work.html"><a href="how-weather-radars-work.html"><i class="fa fa-check"></i><b>1.1</b> How weather radars work</a></li>
<li class="chapter" data-level="1.2" data-path="the-good-and-the-bad.html"><a href="the-good-and-the-bad.html"><i class="fa fa-check"></i><b>1.2</b> The good and the bad</a></li>
<li class="chapter" data-level="1.3" data-path="calibration.html"><a href="calibration.html"><i class="fa fa-check"></i><b>1.3</b> Calibration</a></li>
<li class="chapter" data-level="1.4" data-path="the-need-for-calibrated-radars-in-the-philippines.html"><a href="the-need-for-calibrated-radars-in-the-philippines.html"><i class="fa fa-check"></i><b>1.4</b> The need for (calibrated) radars in the Philippines</a></li>
<li class="chapter" data-level="1.5" data-path="the-approach.html"><a href="the-approach.html"><i class="fa fa-check"></i><b>1.5</b> The approach</a></li>
<li class="chapter" data-level="1.6" data-path="research-questions-and-structure.html"><a href="research-questions-and-structure.html"><i class="fa fa-check"></i><b>1.6</b> Research questions and structure</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="paper-1-using-the-new-philippine-radar-network-to-reconstruct-the-habagat-of-august-2012-monsoon-event.html"><a href="paper-1-using-the-new-philippine-radar-network-to-reconstruct-the-habagat-of-august-2012-monsoon-event.html"><i class="fa fa-check"></i><b>2</b> Paper 1: Using the new Philippine radar network to reconstruct the <em>Habagat of August 2012</em> monsoon event</a><ul>
<li class="chapter" data-level="" data-path="abstract-1.html"><a href="abstract-1.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="radar-data-and-data-processing.html"><a href="radar-data-and-data-processing.html"><i class="fa fa-check"></i><b>2.2</b> Radar data and data processing</a></li>
<li class="chapter" data-level="2.3" data-path="event-reconstruction.html"><a href="event-reconstruction.html"><i class="fa fa-check"></i><b>2.3</b> Event reconstruction</a></li>
<li class="chapter" data-level="2.4" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>2.4</b> Conclusions</a></li>
<li class="chapter" data-level="2.5" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>2.5</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="paper-2-enhancing-the-consistency-of-spaceborne-and-ground-based-radar-comparisons-by-using-beam-blockage-fraction-as-a-quality-filter.html"><a href="paper-2-enhancing-the-consistency-of-spaceborne-and-ground-based-radar-comparisons-by-using-beam-blockage-fraction-as-a-quality-filter.html"><i class="fa fa-check"></i><b>3</b> Paper 2: Enhancing the Consistency of Spaceborne and Ground-Based Radar Comparisons by Using Beam Blockage Fraction as a Quality Filter</a><ul>
<li class="chapter" data-level="" data-path="abstract-2.html"><a href="abstract-2.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="3.1" data-path="introduction-1.html"><a href="introduction-1.html"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3.2</b> Data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#subsec:srpr"><i class="fa fa-check"></i><b>3.2.1</b> Spaceborne precipitation radar</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#ground-radar"><i class="fa fa-check"></i><b>3.2.2</b> Ground radar</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="method.html"><a href="method.html"><i class="fa fa-check"></i><b>3.3</b> Method</a><ul>
<li class="chapter" data-level="3.3.1" data-path="method.html"><a href="method.html#sec:partialbeamblocking"><i class="fa fa-check"></i><b>3.3.1</b> Partial beam shielding and quality index based on beam blockage fraction</a></li>
<li class="chapter" data-level="3.3.2" data-path="method.html"><a href="method.html#subsec:srgrvolumematching"><i class="fa fa-check"></i><b>3.3.2</b> SR–GR Volume Matching</a></li>
<li class="chapter" data-level="3.3.3" data-path="method.html"><a href="method.html#assessment-of-the-average-reflectivity-bias"><i class="fa fa-check"></i><b>3.3.3</b> Assessment of the average reflectivity bias</a></li>
<li class="chapter" data-level="3.3.4" data-path="method.html"><a href="method.html#computational-details"><i class="fa fa-check"></i><b>3.3.4</b> Computational details</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="sec-resultsanddiscussion.html"><a href="sec-resultsanddiscussion.html"><i class="fa fa-check"></i><b>3.4</b> Results and discussion</a><ul>
<li class="chapter" data-level="3.4.1" data-path="sec-resultsanddiscussion.html"><a href="sec-resultsanddiscussion.html#single-event-comparison"><i class="fa fa-check"></i><b>3.4.1</b> Single event comparison</a></li>
<li class="chapter" data-level="3.4.2" data-path="sec-resultsanddiscussion.html"><a href="sec-resultsanddiscussion.html#overall-junenovember-comparison-during-the-5-year-observation-period"><i class="fa fa-check"></i><b>3.4.2</b> Overall June–November comparison during the 5-year observation period</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="conclusions-1.html"><a href="conclusions-1.html"><i class="fa fa-check"></i><b>3.5</b> Conclusions</a></li>
<li class="chapter" data-level="" data-path="acknowledgements-1.html"><a href="acknowledgements-1.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="using-ground-radar-overlaps-to-verify-the-retrieval-of-calibration-bias-estimates-from-spaceborne-platforms.html"><a href="using-ground-radar-overlaps-to-verify-the-retrieval-of-calibration-bias-estimates-from-spaceborne-platforms.html"><i class="fa fa-check"></i><b>4</b> Using ground radar overlaps to verify the retrieval of calibration bias estimates from spaceborne platforms</a><ul>
<li class="chapter" data-level="" data-path="abstract-3.html"><a href="abstract-3.html"><i class="fa fa-check"></i>Abstract</a></li>
<li class="chapter" data-level="4.1" data-path="introduction-2.html"><a href="introduction-2.html"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="sec-data-studyarea.html"><a href="sec-data-studyarea.html"><i class="fa fa-check"></i><b>4.2</b> Data and Study Area</a><ul>
<li class="chapter" data-level="4.2.1" data-path="sec-data-studyarea.html"><a href="sec-data-studyarea.html#subic-radar-sub"><i class="fa fa-check"></i><b>4.2.1</b> Subic radar (SUB)</a></li>
<li class="chapter" data-level="4.2.2" data-path="sec-data-studyarea.html"><a href="sec-data-studyarea.html#tagaytay-radar-tag"><i class="fa fa-check"></i><b>4.2.2</b> Tagaytay radar (TAG)</a></li>
<li class="chapter" data-level="4.2.3" data-path="sec-data-studyarea.html"><a href="sec-data-studyarea.html#spaceborne-precipitation-radar"><i class="fa fa-check"></i><b>4.2.3</b> Spaceborne precipitation radar</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="sec-methods.html"><a href="sec-methods.html"><i class="fa fa-check"></i><b>4.3</b> Methods</a><ul>
<li class="chapter" data-level="4.3.1" data-path="sec-methods.html"><a href="sec-methods.html#subsec:methodoverview"><i class="fa fa-check"></i><b>4.3.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="srgr-matching.html"><a href="srgr-matching.html"><i class="fa fa-check"></i><b>4.4</b> SR–GR matching</a><ul>
<li class="chapter" data-level="4.4.1" data-path="srgr-matching.html"><a href="srgr-matching.html#grgr-matching"><i class="fa fa-check"></i><b>4.4.1</b> GR–GR matching</a></li>
<li class="chapter" data-level="4.4.2" data-path="srgr-matching.html"><a href="srgr-matching.html#estimation-of-path-integrated-attenuation"><i class="fa fa-check"></i><b>4.4.2</b> Estimation of path-integrated attenuation</a></li>
<li class="chapter" data-level="4.4.3" data-path="srgr-matching.html"><a href="srgr-matching.html#beam-blockage"><i class="fa fa-check"></i><b>4.4.3</b> Beam Blockage</a></li>
<li class="chapter" data-level="4.4.4" data-path="srgr-matching.html"><a href="srgr-matching.html#subsec:qualityweighting"><i class="fa fa-check"></i><b>4.4.4</b> Quality index and quality-weighted averaging</a></li>
<li class="chapter" data-level="4.4.5" data-path="srgr-matching.html"><a href="srgr-matching.html#computational-details-1"><i class="fa fa-check"></i><b>4.4.5</b> Computational details</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="sec-results.html"><a href="sec-results.html"><i class="fa fa-check"></i><b>4.5</b> Results and Discussion</a><ul>
<li class="chapter" data-level="4.5.1" data-path="sec-results.html"><a href="sec-results.html#subsec:extendingquality"><i class="fa fa-check"></i><b>4.5.1</b> The effect of extended quality filtering: the case of December 9, 2014</a></li>
<li class="chapter" data-level="4.5.2" data-path="sec-results.html"><a href="sec-results.html#subsec:biasfromoverpass"><i class="fa fa-check"></i><b>4.5.2</b> Estimating the GR calibration bias from SR overpass events</a></li>
<li class="chapter" data-level="4.5.3" data-path="sec-results.html"><a href="sec-results.html#subsec:effectofbias"><i class="fa fa-check"></i><b>4.5.3</b> The effect of bias correction on the GR consistency: case studies</a></li>
<li class="chapter" data-level="4.5.4" data-path="sec-results.html"><a href="sec-results.html#subsec:interpolation"><i class="fa fa-check"></i><b>4.5.4</b> Can we interpolate calibration bias estimates in time?</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="acknowledgements-2.html"><a href="acknowledgements-2.html"><i class="fa fa-check"></i><b>4.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="discussion-limitations-outlook.html"><a href="discussion-limitations-outlook.html"><i class="fa fa-check"></i><b>5</b> Discussion, Limitations, Outlook</a><ul>
<li class="chapter" data-level="5.1" data-path="limitations-of-the-study.html"><a href="limitations-of-the-study.html"><i class="fa fa-check"></i><b>5.1</b> Limitations of the study</a></li>
<li class="chapter" data-level="5.2" data-path="outlook.html"><a href="outlook.html"><i class="fa fa-check"></i><b>5.2</b> Outlook</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="summary-and-conclusion.html"><a href="summary-and-conclusion.html"><i class="fa fa-check"></i><b>6</b> Summary and Conclusion</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PhD Thesis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="method" class="section level2">
<h2><span class="header-section-number">3.3</span> Method</h2>
<div id="sec:partialbeamblocking" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Partial beam shielding and quality index based on beam blockage fraction</h3>
<p>In an ideal situation, SR and GR should have the same measurements for the same volume of the atmosphere, as they are measuring the same target. However, observational differences may arise due to different view geometries, different operating frequencies, different environmental conditions of each instrument, and different processes along the propagation path of the beam. As pointed out before, we focus on beam blockage as an index of GR data quality.</p>
<p>In regions of complex topography, ground radars are typically affected by the effects of beam blockage, induced by the interaction of the beam with the terrain surface resulting in a weakening or even loss of the signal. To quantify that process within the Subic radar coverage, a beam blockage map is generated following the algorithm proposed by <span class="citation">Bech et al. (<a href="#ref-bech_sensitivity_2003" role="doc-biblioref">2003</a>)</span>. It assesses the extent of occultation using a digital elevation model (DEM). While <span class="citation">Bech et al. (<a href="#ref-bech_sensitivity_2003" role="doc-biblioref">2003</a>)</span> used the GTOPO30 DEM at a resolution of around 1 km, higher DEM resolutions are expected to increase the accuracy of estimates of beam blockage fraction, as shown by <span class="citation">Kucera, Krajewski, and Young (<a href="#ref-kucera_radar_2004" role="doc-biblioref">2004</a>)</span>, in particular the near range of the radar <span class="citation">(Cremonini, Moisseev, and Chandrasekar <a href="#ref-cremonini_airborne_2016" role="doc-biblioref">2016</a>)</span>. The DEM used in this study is from the Shuttle Radar Topography Mission (SRTM) data, with 1 arc-second (approximately 30-meter) resolution. The DEM was resampled to the coordinates of the radar bin centroids, using spline interpolation, in order to match the polar resolution of the radar data (500 m in range and 1<span class="math inline">\(^{\circ}\)</span> in azimuth, extending to a maximum range of 120 km from the radar site; see Figure <a href="data.html#fig:studyarea">3.1</a>). A beam blockage map is generated for all available elevation angles.</p>
<p>The beam blockage fraction was calculated for each bin and each antenna pointing angle. The cumulative beam blockage was then calculated along each ray. A cumulative beam blockage fraction (BBF) of 1.0 corresponds to full occlusion, and a value of 0.0 to perfect visibility.</p>
<p>The quality index based on beam blockage fraction is then computed following <span class="citation">Zhang et al. (<a href="#ref-zhang_radar_2011" role="doc-biblioref">2011</a>)</span> as</p>
<p><span class="math display">\[
\begin{equation}
\scriptstyle
Q_{BBF} =
\begin{cases}
1 &amp; BBF \leq 0.1\\
1 - \frac{BBF - 0.1}{0.4} &amp; 0.1 &lt; BBF \leq 0.5\\
0 &amp; BBF &gt; 0.5
\end{cases}
\end{equation}
\]</span></p>
<p>A slightly different formulation to transform partial beam blockage to a quality index has been presented in other studies <span class="citation">(Figueras i Ventura and Tabary <a href="#ref-figueras_i_ventura_new_2013" role="doc-biblioref">2013</a>; Fornasiero et al. <a href="#ref-fornasiero_effects_2005" role="doc-biblioref">2005</a>; Ośródka, Szturc, and Jurczyk <a href="#ref-osrodka_chain_2014" role="doc-biblioref">2014</a>; Rinollo et al. <a href="#ref-rinollo_definition_2013" role="doc-biblioref">2013</a>)</span> where the quality is zero (0) if BBF is above a certain threshold, and then linearly increases to one (1) above that threshold. It should be noted that these approaches are equally valid and can be used in determining the quality index based on beam blockage.</p>
<center>
<div class="figure"><span id="fig:BBF"></span>
<img src="Figures/BBF.png" alt="Quality index map of the beam blockage fraction for the Subic radar at (a) 0.0$^{\circ}$, (b) 0.5$^{\circ}$, (c) 1.0$^{\circ}$, and (d) 1.5$^{\circ}$ elevation angles." width="70%" />
<p class="caption">
Figure 3.2: Quality index map of the beam blockage fraction for the Subic radar at (a) 0.0<span class="math inline">\(^{\circ}\)</span>, (b) 0.5<span class="math inline">\(^{\circ}\)</span>, (c) 1.0<span class="math inline">\(^{\circ}\)</span>, and (d) 1.5<span class="math inline">\(^{\circ}\)</span> elevation angles.
</p>
</div>
</center>
<p>Figure <a href="method.html#fig:BBF">3.2</a> shows the beam blockage map for the two lowest elevation angles of each scanning strategy. Figure <a href="method.html#fig:BBF">3.2</a>a and c are for 0.0<span class="math inline">\(^{\circ}\)</span> and 1.0<span class="math inline">\(^{\circ}\)</span>, which are the two lowest elevation angles in 2015, while Figure <a href="method.html#fig:BBF">3.2</a>b and d are for 0.5<span class="math inline">\(^{\circ}\)</span> and 1.5<span class="math inline">\(^{\circ}\)</span>, which are the two lowest elevation angles for the rest of the dataset.</p>
<p>As expected, the degree of beam blockage decreases with increasing antenna elevation, yielding the most pronounced beam blockage at 0.0<span class="math inline">\(^{\circ}\)</span>. Each blocked sector can be explained by the topography (see Figure <a href="data.html#fig:studyarea">3.1</a>), with the Zambales Mountains causing blockage in the northern sector, Mt. Natib in the southern sector, and the Redondo peninsula mountains in the western sector. The Sierra Madre also causes some partial beam blocking in the far east, and a narrow partial blocking northeast of the station where Mt. Arayat is located. As the elevation angle increases, the beam blockage becomes less pronounced or even disappears. Substantial blockage persists, however, for the higher elevation angles in the northern and southern sectors.</p>
</div>
<div id="subsec:srgrvolumematching" class="section level3">
<h3><span class="header-section-number">3.3.2</span> SR–GR Volume Matching</h3>
<div class="figure"><span id="fig:GeometricIntersection"></span>
<img src="Figures/geomintersection.png" alt="Diagram illustrating the geometric intersection. Left panel shows a single SR beam intersecting GR sweeps of two different elevation angles. The two top right panels illustrate the intersection of SR--GR sample volumes in the near and far ranges and the two bottom right panels show the projection of these intersections along an SR ray. From Schwaller and Morris (2011) (C) American Meteorological Society. Used with permission."  />
<p class="caption">
Figure 3.3: Diagram illustrating the geometric intersection. Left panel shows a single SR beam intersecting GR sweeps of two different elevation angles. The two top right panels illustrate the intersection of SR–GR sample volumes in the near and far ranges and the two bottom right panels show the projection of these intersections along an SR ray. From Schwaller and Morris (2011) (C) American Meteorological Society. Used with permission.
</p>
</div>
<p>SR and GR data were matched only for the wet period within each year, which is from June to December. Several meta-data parameters were extracted from the TRMM 2A23 and GPM 2AKu products for each SR gate, such as the corresponding ray’s brightband height and width, gate coordinates in three dimensions (longitude and latitude of each ray’s Earth intercept and range gate index), time of overpass, precipitation type (<em>stratiform</em>, <em>convective</em>, or <em>other</em>), and rain indicators (<em>rain certain</em> or <em>no-rain</em>). The parallax-corrected altitude (above mean sea level) and horizontal location (with respect to the GR) of each gate were determined as outlined in the appendix of <span class="citation">Warren et al. (<a href="#ref-warren_calibrating_2018" role="doc-biblioref">2018</a>)</span>. From the brightband height/width and the altitude of each SR gate, the brightband membership of each gate was calculated by grouping all rays in an overpass and computing the mean brightband height and width. A ratio value of less than zero indicates that the gate is below the brightband, and greater than one indicates that the gate is above the brightband, and a value between zero and one means that the gate is within the brightband. Only gates below and above the brightband were considered in the comparison. <span class="citation">Warren et al. (<a href="#ref-warren_calibrating_2018" role="doc-biblioref">2018</a>)</span> found a positive bias in GR–SR reflectivity difference for volume-matched samples within the melting layer, compared to those above and below the melting layer. They speculated that this was due to underestimation of the Ku- to S-band frequency correction for melting snow. In addition, while usually the samples above the brightband are used in GPM validation, there are significantly more samples below the melting layer, especially in a tropical environment such as the Philippines. To ensure that there are sufficient bins with actual rain included in the comparison, overpasses with less than 100 gates flagged as rain certain were discarded.</p>
<p>For each SR overpass, the GR sweep with the scan time closest to the overpass time within a 10-min window ($$5-min from overpass time) was selected. Both the SR and GR data were then geo-referenced into a common azimuthal equidistant projection centered on the location of the ground radar.</p>
<p>In order to minimize systematic differences in comparing the SR and GR reflectivities caused by the different measuring frequencies, the SR reflectivities were converted from Ku- to S-band following the formula:</p>
<p><span class="math display">\[
\begin{equation}
Z(S) = Z(Ku) + \sum_{i=0}^4a_i [Z(Ku)]^i
\end{equation}
\]</span></p>
<p>where the <span class="math inline">\(a_i\)</span> are the coefficients for dry snow and dry hail, rain, and in between at varying melting stages (Table 1 of <span class="citation">Cao et al. (<a href="#ref-cao_empirical_2013" role="doc-biblioref">2013</a>)</span>). We used the coefficients for snow in the reflectivity conversion above the brightband, following <span class="citation">Warren et al. (<a href="#ref-warren_calibrating_2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>The actual volume matching algorithm closely follows the work of <span class="citation">Schwaller and Morris (<a href="#ref-schwaller_ground_2011" role="doc-biblioref">2011</a>)</span>, where SR reflectivity is spatially and temporally matched with GR reflectivity without interpolation. The general concept is highlighted by Figure <a href="method.html#fig:GeometricIntersection">3.3</a>: each matching sample consists of bins from only <em>one SR ray</em> and <em>one GR sweep</em>. From the SR ray, those bins were selected that intersect with the vertical extent of a specific GR sweep at the SR ray location. From each GR sweep, those bins were selected that intersect with the horizontal footprint of the SR ray at the corresponding altitude. The SR and GR reflectivity of each matched volume was computed as the average reflectivity of the intersecting SR and GR bins.%, where the averaging is done in linear units (<span class="math inline">\(mm^6/m^3\)</span>). %The entire workflow of this volume matching procedure is based on wradlib functions and available at <a href="https://github.com/wradlib/radargpm-beamblockage" class="uri">https://github.com/wradlib/radargpm-beamblockage</a>.</p>
<p>The nominal minimum sensitivity of both TRMM PR and GPM KuPR is 18 dBZ, so only values above this level were considered in the calculation of average SR reflectivity in the matched volume. In addition, the fraction of SR gates within a matched volume above that threshold was also recorded. On the other hand, all GR bins are included in the calculation of average GR reflectivity, after setting the bins with reflectivities below 0.0 dBZ to 0.0 dBZ, as suggested by <span class="citation">Morris and Schwaller (<a href="#ref-morris_sensitivity_2011" role="doc-biblioref">2011</a>)</span>. The filtering criteria applied in the workflow are summarized in Table <a href="method.html#tab:filteringcriteria">3.2</a>.</p>
<table>
<caption><span id="tab:filteringcriteria">Table 3.2: </span> Filtering criteria for the matching workflow.</caption>
<thead>
<tr class="header">
<th>Criteria</th>
<th>Condition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Minimum number of pixels in overpass tagged as ’rain’</td>
<td>100</td>
</tr>
<tr class="even">
<td>Brightband membership</td>
<td>below or above</td>
</tr>
<tr class="odd">
<td>GR range limits (min–max)</td>
<td>15 – 115 km</td>
</tr>
<tr class="even">
<td>Minimum fraction of bins above minimum SR sensitivity</td>
<td>0.7</td>
</tr>
<tr class="odd">
<td>Minimum fraction of bins above minimum GR sensitivity</td>
<td>0.7</td>
</tr>
<tr class="even">
<td>Maximum time difference between SR and GR</td>
<td>5 min</td>
</tr>
<tr class="odd">
<td>Minimum PR reflectivity</td>
<td>18 dBZ</td>
</tr>
</tbody>
</table>
</div>
<div id="assessment-of-the-average-reflectivity-bias" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Assessment of the average reflectivity bias</h3>
<p>Beam blockage and the corresponding GR quality maps were computed for each GR bin (cf. Section <a href="method.html#sec:partialbeamblocking">3.3.1</a>. For each matched SR–GR volume, the data quality was then based on the minimum quality of the GR bins in that volume.</p>
<p>To analyze the effect of data quality on the estimation of GR calibration bias, we compared two estimation approaches: a simple mean bias that does not take into account beam blockage, and a weighted mean bias that considers the quality value of each sample as weights. The corresponding standard deviation and weighted standard deviation were calculated as well. The overall process is summarized in Figure <a href="method.html#fig:MethodFlowchart">3.4</a>. In this way, we provide an overview of the variability of our bias estimates over time.</p>
<div class="figure"><span id="fig:MethodFlowchart"></span>
<img src="Figures/SRGR_flowchart.png" alt="Flowchart describing the processing steps to calculate the mean bias and the weighted mean bias between ground radar data and satellite radar data."  />
<p class="caption">
Figure 3.4: Flowchart describing the processing steps to calculate the mean bias and the weighted mean bias between ground radar data and satellite radar data.
</p>
</div>
</div>
<div id="computational-details" class="section level3">
<h3><span class="header-section-number">3.3.4</span> Computational details</h3>
<p>In order to promote transparency and reproducibility of this study, we mostly followed the guidelines provided by <span class="citation">Irving (<a href="#ref-irving_minimum_2016" role="doc-biblioref">2016</a>)</span> which have also been implemented by a number of recent studies <span class="citation">(Blumberg et al. <a href="#ref-blumberg_sharppy_2017" role="doc-biblioref">2017</a>; Irving and Simmonds <a href="#ref-irving_new_2016" role="doc-biblioref">2016</a>; Rasp, Selz, and Craig <a href="#ref-rasp_variability_2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>The entire processing workflow is based on <em>wradlib</em> <span class="citation">(M. Heistermann, Jacobi, and Pfaff <a href="#ref-heistermann_technical_2013" role="doc-biblioref">2013</a>)</span>, an extensively documented open-source software library for processing weather radar data. At the time of writing, we used version 1.0.0 released on 01 April 2018, based on Python 3.6. The main dependencies include Numerical Python (NumPy; <span class="citation">Oliphant (<a href="#ref-oliphant_guide_2015" role="doc-biblioref">2015</a>)</span>), Matplotlib <span class="citation">(Hunter <a href="#ref-hunter_matplotlib_2007" role="doc-biblioref">2007</a>)</span>, Scientific Python (SciPy; <span class="citation">Jones, Oliphant, and Peterson (<a href="#ref-jones_scipy_2014" role="doc-biblioref">2014</a>)</span>), h5py <span class="citation">(Collette <a href="#ref-collette_python_2013" role="doc-biblioref">2013</a>)</span>, netCDF4 <span class="citation">(Rew et al. <a href="#ref-rew_unidata_1989" role="doc-biblioref">1989</a>)</span>, and gdal <span class="citation">(GDAL Development Team <a href="#ref-gdal_development_team_gdal_2017" role="doc-biblioref">2017</a>)</span>.</p>
<p>Reading the TRMM 2A23 and 2A25 version 7 data, GPM 2AKu version 5A data, and Subic ground radar data in the netCDF format converted through the EDGE software of EEC radars was done through the input-output module of wradlib. The beam blockage modelling is based on the <span class="citation">Bech et al. (<a href="#ref-bech_sensitivity_2003" role="doc-biblioref">2003</a>)</span> method implemented as a function in wradlib’s data quality module. The volume-matching procedure is built upon the georeferencing and zonal statistics modules, accompanied by Pandas <span class="citation">(McKinney <a href="#ref-mckinney_data_2010" role="doc-biblioref">2010</a>)</span> for organizing and analysing the resulting database of matched bins. Visualization was carried out with the help of matplotlib <span class="citation">(Hunter <a href="#ref-hunter_matplotlib_2007" role="doc-biblioref">2007</a>)</span> and Py-ART <span class="citation">(Helmus and Collis <a href="#ref-helmus_python_2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>An accompanying GitHub repository that hosts the Jupyter notebooks of the workflow and sample data is made available at <a href="https://github.com/wradlib/radargpm-beamblockage" class="uri">https://github.com/wradlib/radargpm-beamblockage</a>.</p>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-bech_sensitivity_2003">
<p>Bech, Joan, Bernat Codina, Jeroni Lorente, and David Bebbington. 2003. “The Sensitivity of Single Polarization Weather Radar Beam Blockage Correction to Variability in the Vertical Refractivity Gradient.” <em>Journal of Atmospheric and Oceanic Technology</em> 20 (6): 845–55. <a href="http://journals.ametsoc.org/doi/abs/10.1175/1520-0426(2003)020%3C0845:TSOSPW%3E2.0.CO;2">http://journals.ametsoc.org/doi/abs/10.1175/1520-0426(2003)020%3C0845:TSOSPW%3E2.0.CO;2</a>.</p>
</div>
<div id="ref-blumberg_sharppy_2017">
<p>Blumberg, William G., Kelton T. Halbert, Timothy A. Supinie, Patrick T. Marsh, Richard L. Thompson, and John A. Hart. 2017. “SHARPpy: An Open-Source Sounding Analysis Toolkit for the Atmospheric Sciences.” <em>Bulletin of the American Meteorological Society</em> 98 (8): 1625–36. <a href="https://doi.org/10.1175/BAMS-D-15-00309.1">https://doi.org/10.1175/BAMS-D-15-00309.1</a>.</p>
</div>
<div id="ref-cao_empirical_2013">
<p>Cao, Qing, Yang Hong, Youcun Qi, Yixin Wen, Jian Zhang, Jonathan J. Gourley, and Liang Liao. 2013. “Empirical Conversion of the Vertical Profile of Reflectivity from Ku-Band to S-Band Frequency.” <em>Journal of Geophysical Research: Atmospheres</em> 118 (4): 1814–25. <a href="https://doi.org/10.1002/jgrd.50138">https://doi.org/10.1002/jgrd.50138</a>.</p>
</div>
<div id="ref-collette_python_2013">
<p>Collette, Andrew. 2013. <em>Python and HDF5</em>. O’Reilly.</p>
</div>
<div id="ref-cremonini_airborne_2016">
<p>Cremonini, Roberto, Dmitri Moisseev, and Venkatachalam Chandrasekar. 2016. “Airborne Laser Scan Data: A Valuable Tool with Which to Infer Weather Radar Partial Beam Blockage in Urban Environments.” <em>Atmospheric Measurement Techniques</em> 9 (10): 5063–75. <a href="https://doi.org/10.5194/amt-9-5063-2016">https://doi.org/10.5194/amt-9-5063-2016</a>.</p>
</div>
<div id="ref-figueras_i_ventura_new_2013">
<p>Figueras i Ventura, Jordi, and Pierre Tabary. 2013. “The New French Operational Polarimetric Radar Rainfall Rate Product.” <em>Journal of Applied Meteorology and Climatology</em> 52 (8): 1817–35. <a href="https://doi.org/10.1175/JAMC-D-12-0179.1">https://doi.org/10.1175/JAMC-D-12-0179.1</a>.</p>
</div>
<div id="ref-fornasiero_effects_2005">
<p>Fornasiero, A., P. P. Alberoni, R. Amorati, L. Ferraris, and A. C. Taramasso. 2005. “Effects of Propagation Conditions on Radar Beam-Ground Interaction: Impact on Data Quality.” <em>Advances in Geosciences</em> 2 (June): 201–8. <a href="https://hal.archives-ouvertes.fr/hal-00297387">https://hal.archives-ouvertes.fr/hal-00297387</a>.</p>
</div>
<div id="ref-gdal_development_team_gdal_2017">
<p>GDAL Development Team. 2017. “GDAL - Geospatial Data Abstraction Library, Version 2.2.3.” Open Source Geospatial Foundation. <a href="http://www.gdal.org/">http://www.gdal.org/</a>.</p>
</div>
<div id="ref-heistermann_technical_2013">
<p>Heistermann, M., S. Jacobi, and T. Pfaff. 2013. “Technical Note: An Open Source Library for Processing Weather Radar Data (Wradlib).” <em>Hydrology and Earth System Sciences</em> 17 (2): 863–71. <a href="https://doi.org/10.5194/hess-17-863-2013">https://doi.org/10.5194/hess-17-863-2013</a>.</p>
</div>
<div id="ref-helmus_python_2016">
<p>Helmus, Jonathan, and Scott Collis. 2016. “The Python ARM Radar Toolkit (Py-ART), a Library for Working with Weather Radar Data in the Python Programming Language.” <em>Journal of Open Research Software</em> 4 (1). <a href="https://doi.org/10.5334/jors.119">https://doi.org/10.5334/jors.119</a>.</p>
</div>
<div id="ref-hunter_matplotlib_2007">
<p>Hunter, J. D. 2007. “Matplotlib: A 2D Graphics Environment.” <em>Computing in Science Engineering</em> 9 (3): 90–95. <a href="https://doi.org/10.1109/MCSE.2007.55">https://doi.org/10.1109/MCSE.2007.55</a>.</p>
</div>
<div id="ref-irving_minimum_2016">
<p>Irving, Damien. 2016. “A Minimum Standard for Publishing Computational Results in the Weather and Climate Sciences.” <em>Bulletin of the American Meteorological Society</em> 97 (7): 1149–58. <a href="https://doi.org/10.1175/BAMS-D-15-00010.1">https://doi.org/10.1175/BAMS-D-15-00010.1</a>.</p>
</div>
<div id="ref-irving_new_2016">
<p>Irving, Damien, and Ian Simmonds. 2016. “A New Method for Identifying the Pacific–South American Pattern and Its Influence on Regional Climate Variability.” <em>Journal of Climate</em> 29 (17): 6109–25. <a href="https://doi.org/10.1175/JCLI-D-15-0843.1">https://doi.org/10.1175/JCLI-D-15-0843.1</a>.</p>
</div>
<div id="ref-jones_scipy_2014">
<p>Jones, Eric, Travis E. Oliphant, and Pearu Peterson. 2014. “SciPy: Open Source Scientific Tools for Python.”</p>
</div>
<div id="ref-kucera_radar_2004">
<p>Kucera, Paul A., Witold F. Krajewski, and C. Bryan Young. 2004. “Radar Beam Occultation Studies Using GIS and DEM Technology: An Example Study of Guam.” <em>Journal of Atmospheric and Oceanic Technology</em> 21 (7): 995–1006. <a href="http://journals.ametsoc.org/doi/full/10.1175/1520-0426(2004)021%3C0995:RBOSUG%3E2.0.CO%3B2">http://journals.ametsoc.org/doi/full/10.1175/1520-0426(2004)021%3C0995:RBOSUG%3E2.0.CO%3B2</a>.</p>
</div>
<div id="ref-mckinney_data_2010">
<p>McKinney, Wes. 2010. “Data Structures for Statistical Computing in Python.” In <em>Proceedings of the 9th Python in Science Conference</em>, 445:51–56. Austin, TX.</p>
</div>
<div id="ref-morris_sensitivity_2011">
<p>Morris, Kenneth R., and Mathew Schwaller. 2011. “Sensitivity of Spaceborne and Ground Radar Comparison Results to Data Analysis Methods and Constraints.” In <em>35th Conference on Radar Meteorology</em>. Pittsburgh, PA: American Meteorological Society. <a href="https://ams.confex.com/ams/35Radar/webprogram/Manuscript/Paper191729/AMS_35th_Radar_paper_final.pdf">https://ams.confex.com/ams/35Radar/webprogram/Manuscript/Paper191729/AMS_35th_Radar_paper_final.pdf</a>.</p>
</div>
<div id="ref-oliphant_guide_2015">
<p>Oliphant, Travis E. 2015. <em>Guide to NumPy</em>. 2nd ed. USA: CreateSpace Independent Publishing Platform.</p>
</div>
<div id="ref-osrodka_chain_2014">
<p>Ośródka, Katarzyna, Jan Szturc, and Anna Jurczyk. 2014. “Chain of Data Quality Algorithms for 3-D Single-Polarization Radar Reflectivity (RADVOL-QC System).” <em>Meteorological Applications</em> 21 (2): 256–70. <a href="https://doi.org/10.1002/met.1323">https://doi.org/10.1002/met.1323</a>.</p>
</div>
<div id="ref-rasp_variability_2018">
<p>Rasp, Stephan, Tobias Selz, and George C. Craig. 2018. “Variability and Clustering of Midlatitude Summertime Convection: Testing the Craig and Cohen Theory in a Convection-Permitting Ensemble with Stochastic Boundary Layer Perturbations.” <em>Journal of the Atmospheric Sciences</em> 75 (2): 691–706.</p>
</div>
<div id="ref-rew_unidata_1989">
<p>Rew, Russ, Glenn Davis, Steve Emmerson, Cathy Cormack, John Caron, Robert Pincus, Ed Hartnett, Dennis Heimbigner, Lynton Appel, and Ward Fisher. 1989. “Unidata NetCDF.” UCAR/NCAR - Unidata. <a href="http://www.unidata.ucar.edu/software/netcdf/">http://www.unidata.ucar.edu/software/netcdf/</a>.</p>
</div>
<div id="ref-rinollo_definition_2013">
<p>Rinollo, A., G. Vulpiani, S. Puca, P. Pagliara, J. Kaňák, E. Lábó, L’. Okon, et al. 2013. “Definition and Impact of a Quality Index for Radar-Based Reference Measurements in the H-SAF Precipitation Product Validation.” <em>Natural Hazards and Earth System Science</em> 13 (10): 2695–2705. <a href="https://doi.org/10.5194/nhess-13-2695-2013">https://doi.org/10.5194/nhess-13-2695-2013</a>.</p>
</div>
<div id="ref-schwaller_ground_2011">
<p>Schwaller, Mathew R., and K. Robert Morris. 2011. “A Ground Validation Network for the Global Precipitation Measurement Mission.” <em>Journal of Atmospheric and Oceanic Technology</em> 28 (3): 301–19. <a href="https://doi.org/10.1175/2010JTECHA1403.1">https://doi.org/10.1175/2010JTECHA1403.1</a>.</p>
</div>
<div id="ref-warren_calibrating_2018">
<p>Warren, Robert A., Alain Protat, Steven T. Siems, Hamish A. Ramsay, Valentin Louf, Michael J. Manton, and Thomas A. Kane. 2018. “Calibrating Ground-Based Radars Against TRMM and GPM.” <em>Journal of Atmospheric and Oceanic Technology</em>, February. <a href="https://doi.org/10.1175/JTECH-D-17-0128.1">https://doi.org/10.1175/JTECH-D-17-0128.1</a>.</p>
</div>
<div id="ref-zhang_radar_2011">
<p>Zhang, JIAN, YOUCUN Qi, K. Howard, C. Langston, and B. Kaney. 2011. “Radar Quality Index (RQI)—A Combined Measure of Beam Blockage and VPR Effects in a National Network.” In <em>Proceedings, International Symposium on Weather Radar and Hydrology</em>. <a href="http://www.nssl.noaa.gov/projects/q2/tutorial/images/mosaic/WRaH_Proceedings_Zhang-et-al_v3.pdf">http://www.nssl.noaa.gov/projects/q2/tutorial/images/mosaic/WRaH_Proceedings_Zhang-et-al_v3.pdf</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-resultsanddiscussion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
